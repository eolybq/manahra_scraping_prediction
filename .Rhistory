~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23731.xlsx", "Výsledky/23732.xlsx"), 1)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23726.xlsx", "Výsledky/23827.xlsx"), 2)
rm(list = ls())
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23826.xlsx", "Výsledky/23827.xlsx"), 2)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
# Regrese=============
rm(list = ls())
str(ceny)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/24191.xlsx", "Výsledky/24192.xlsx"), 5)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy ve středu !!!!!!!===========
vykazy_to_data <- function(kolo, vykazy_list) {
# Obch jmění
vlastni_kap_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "Vlastní kapitál", ][-1]))
obch_jmeni_akcie <- map_dbl(c(vlastni_kap_list[[1]], vlastni_kap_list[[2]]), ~ as.numeric(.) * 1000 / 28e6)
data[data$kolo == (kolo + 1) & data$podnik %in% names(obch_jmeni_akcie), "obch_jmeni_akcie_t-1"] <- rep(obch_jmeni_akcie, each = 7)
# HV
hv_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "HV celkem po zdanění", ][-1]))
hv <- map_dbl(c(hv_list[[1]], hv_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(hv), "HV_t-1"] <- rep(hv, each = 7)
return(data)
}
pridani_vykazu <- function(nove_vykazy, kolo) {
soubory <- dir("Výkazy/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vykazy),
~ {
var <- read_excel(., n_max = 90)
var[-1]
})
vykazy_list <- map(data_list, na.omit)
vykazy_to_data(kolo, vykazy_list)
}
# Přidání nových výkazů /  Načtení výkazů do "data" (jednou za 1 kolo / 7 obch dnu)
# Vyměnit nazev souboru vykazu a kolo
data <- pridani_vykazu(c("Výkazy/24225.xlsx", "Výkazy/24226.xlsx"), 5)
# Regrese=============
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy ve středu !!!!!!!===========
vykazy_to_data <- function(kolo, vykazy_list) {
# Obch jmění
vlastni_kap_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "Vlastní kapitál", ][-1]))
obch_jmeni_akcie <- map_dbl(c(vlastni_kap_list[[1]], vlastni_kap_list[[2]]), ~ as.numeric(.) * 1000 / 28e6)
data[data$kolo == (kolo + 1) & data$podnik %in% names(obch_jmeni_akcie), "obch_jmeni_akcie_t-1"] <- rep(obch_jmeni_akcie, each = 7)
# HV
hv_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "HV celkem po zdanění", ][-1]))
hv <- map_dbl(c(hv_list[[1]], hv_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(hv), "HV_t-1"] <- rep(hv, each = 7)
return(data)
}
pridani_vykazu <- function(nove_vykazy, kolo) {
soubory <- dir("Výkazy/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vykazy),
~ {
var <- read_excel(., n_max = 90)
var[-1]
})
vykazy_list <- map(data_list, na.omit)
vykazy_to_data(kolo, vykazy_list)
}
# Přidání nových výkazů /  Načtení výkazů do "data" (jednou za 1 kolo / 7 obch dnu)
# Vyměnit nazev souboru vykazu a kolo
data <- pridani_vykazu(c("Výkazy/24225.xlsx", "Výkazy/24226.xlsx"), 5)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/ceny.RData")
View(ceny)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(35)
save_volume(35)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(37)
save_volume(37)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(41)
save_volume(41)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/24191.xlsx", "Výsledky/24192.xlsx"), 5)
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/24287.xlsx", "Výsledky/24288.xlsx"), 6)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy ve středu !!!!!!!===========
vykazy_to_data <- function(kolo, vykazy_list) {
# Obch jmění
vlastni_kap_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "Vlastní kapitál", ][-1]))
obch_jmeni_akcie <- map_dbl(c(vlastni_kap_list[[1]], vlastni_kap_list[[2]]), ~ as.numeric(.) * 1000 / 28e6)
data[data$kolo == (kolo + 1) & data$podnik %in% names(obch_jmeni_akcie), "obch_jmeni_akcie_t-1"] <- rep(obch_jmeni_akcie, each = 7)
# HV
hv_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "HV celkem po zdanění", ][-1]))
hv <- map_dbl(c(hv_list[[1]], hv_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(hv), "HV_t-1"] <- rep(hv, each = 7)
return(data)
}
pridani_vykazu <- function(nove_vykazy, kolo) {
soubory <- dir("Výkazy/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vykazy),
~ {
var <- read_excel(., n_max = 90)
var[-1]
})
vykazy_list <- map(data_list, na.omit)
vykazy_to_data(kolo, vykazy_list)
}
# Přidání nových výkazů /  Načtení výkazů do "data" (jednou za 1 kolo / 7 obch dnu)
# Vyměnit nazev souboru vykazu a kolo
data <- pridani_vykazu(c("Výkazy/24312.xlsx", "Výkazy/24313.xlsx"), 6)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(42)
save_volume(42)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(43)
save_volume(43)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
library(readxl)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(44)
save_volume(44)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(45)
save_volume(45)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(48)
save_volume(48)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
save(data, file = "data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(49)
save_volume(49)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
})
View(ceny)
View(ceny_t_1)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/24399.xlsx", "Výsledky/24400.xlsx"), 7)
save(data, file = "data/data.RData")
