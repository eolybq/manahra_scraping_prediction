library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(6)
save_volume(6)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
rm(list = ls())
1 + 1
#| echo: false
2 * 2
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(7)
save_volume(7)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
rm(list = ls())
load("data/data.RData")
# Regrese podnik
model_list <- list()
podniky_vekt <- c("11", "12", "13", "14", "15", "16", "17", "21", "22", "23", "24", "25", "26", "27", "28")
for (pd in podniky_vekt) {
model <- lm(cena ~ `cena_t-1` + `objem_burza_t-1` + `obch_jmeni_akcie_t-1` + `HV_t-1` + `neprodana_auta_t-1` + kolo, data = filter(data, podnik == pd), na.action = na.exclude)
model_list[[pd]] <- model
}
summary(model_list[[1]])
# Regrese=============
rm(list = ls())
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23731.xlsx", "Výsledky/23732.xlsx"), 1)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23731.xlsx", "Výsledky/23732.xlsx"), 1)
data[data$podnik == 23, ]
data[data$podnik == 23 && data$kolo ==  2, ]
data[data$podnik == 23 & data$kolo ==  2, ]
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy ve středu !!!!!!!===========
vykazy_to_data <- function(kolo, vykazy_list) {
# Obch jmění
vlastni_kap_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "Vlastní kapitál", ][-1]))
obch_jmeni_akcie <- map_dbl(c(vlastni_kap_list[[1]], vlastni_kap_list[[2]]), ~ as.numeric(.) * 1000 / 28e6)
data[data$kolo == (kolo + 1) & data$podnik %in% names(obch_jmeni_akcie), "obch_jmeni_akcie_t-1"] <- rep(obch_jmeni_akcie, each = 7)
# HV
hv_list <- map(vykazy_list, ~ unlist(.[.[[1]] == "HV celkem po zdanění", ][-1]))
hv <- map_dbl(c(hv_list[[1]], hv_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(hv), "HV_t-1"] <- rep(hv, each = 7)
return(data)
}
pridani_vykazu <- function(nove_vykazy, kolo) {
soubory <- dir("Výkazy/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vykazy),
~ {
var <- read_excel(., n_max = 90)
var[-1]
})
vykazy_list <- map(data_list, na.omit)
vykazy_to_data(kolo, vykazy_list)
}
# Přidání nových výkazů /  Načtení výkazů do "data" (jednou za 1 kolo / 7 obch dnu)
# Vyměnit nazev souboru vykazu a kolo
data <- pridani_vykazu(c("Výkazy/23765.xlsx", "Výkazy/23766.xlsx"), 1)
View(data)
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23731.xlsx", "Výsledky/23732.xlsx"), 1)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
View(data)
load("data/data.RData")
plot(data$kolo, data[data$podnik == "23", "HV_t-1"])
plot(data[data$podnik=="23", "kolo"], data[data$podnik == "23", "HV_t-1"])
load("data/ceny.RData")
View(ceny)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# vytvoreni tabulky
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(8)
save_volume(8)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
View(data)
load("data/ceny.RData")
load("data/ceny_t_1.RData")
View(ceny)
View(ceny_t_1)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(9)
save_volume(9)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
source("C:/Users/jezva/Desktop/R/Projekty/burza_predikce/scraping.R", echo=TRUE)
source("C:/Users/jezva/Desktop/R/Projekty/burza_predikce/scraping.R")
source("C:/Users/jezva/Desktop/R/Projekty/burza_predikce/scraping.R", echo=TRUE)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
View(ceny)
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(10)
save_volume(10)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
View(data)
load("data/ceny.RData")
View(ceny)
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(11)
save_volume(11)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(12)
save_volume(12)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(13)
save_volume(13)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
save_price(14)
save_volume(14)
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# ceny==========
# ulozeni cen a objemu a cena_t-1 do "data"
walk(names(ceny[-1]), ~ {
data[data$podnik == ., "cena"] <<- ceny[[.]]
data[data$podnik == ., "objem_burza_t-1"] <<- volume[[.]]
data[data$podnik == ., "cena_t-1"] <<- ceny_t_1[[.]]
}
)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
library(readxl)
library(readr)
library(tibble)
library(dplyr)
library(purrr)
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23731.xlsx", "Výsledky/23732.xlsx"), 1)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23726.xlsx", "Výsledky/23827.xlsx"), 2)
rm(list = ls())
# Scraping
# Zadat vždy burzovní kolo (Výysledky ze dne "".) do fce
source("./scraping.R")
rm(list = ls())
load("data/ceny.RData")
load("data/ceny_t_1.RData")
load("data/objem.RData")
load("data/data.RData")
# Vždy v pondělí!!!!!=========
# Výsledky trhu / neprodaná auta
vysledky_to_data <- function(kolo, vysledky_list) {
zasoby_list <- map(vysledky_list, ~ unlist(.[.[[1]] == "Zásoby", ][-c(1, ncol(.))]))
zasoby_list <- map(zasoby_list, ~ .[!is.na(.)])
neprodana_auta <- map_dbl(c(zasoby_list[[1]], zasoby_list[[2]]), ~ as.numeric(.))
data[data$kolo == (kolo + 1) & data$podnik %in% names(neprodana_auta), "neprodana_auta_t-1"] <- rep(neprodana_auta, each = 7)
return(data)
}
pridani_vysledku <- function(nove_vysledky, kolo) {
soubory <- dir("Výsledky/", pattern = "*.xlsx", full.names = TRUE)
data_list <- map(keep(soubory, ~. %in% nove_vysledky),
~ {
var <- read_excel(., skip = 1, n_max = 10)
var
})
vysledky_to_data(kolo, data_list)
}
# Přidání nových výsledků /  Načtení výsledků do "data" (jednou za 1 kolo / 7 obch dnu)
data <- pridani_vysledku(c("Výsledky/23826.xlsx", "Výsledky/23827.xlsx"), 2)
save(data, file = "data/data.RData")
# Regrese=============
rm(list = ls())
load("data/data.RData")
# Regrese=============
rm(list = ls())
str(ceny)
